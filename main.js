'use strict';

{
  const question = document.getElementById('question');
  const choices = document.getElementById('choices');
  const btn = document.getElementById('btn');
  const result = document.getElementById('result');
  const scoreLabel = document.querySelector('#result > p');

  //é…åˆ—ã®ï¼ç•ªç›®ã‚’æ­£è§£ã«ã™ã‚‹äº‹
  const quizSet = /*shuffle(*/[
    {q: '(ç®—æ•°)è¨ˆç®—ã‚’ã—ã¾ã—ã‚‡ã†ã€‚ï¼š70Ã—2=', c: ['140', '170', '120']},
    {q: '(ç®—æ•°)è¨ˆç®—ã‚’ã—ã¾ã—ã‚‡ã†ã€‚ï¼š60Ã—6=', c: ['360', '300', '320']},
    {q: '(ç®—æ•°)è¨ˆç®—ã‚’ã—ã¾ã—ã‚‡ã†ã€‚ï¼š800Ã—3=', c: ['2400', '2100', '240']},
    {q: '(ç®—æ•°)è¨ˆç®—ã‚’ã—ã¾ã—ã‚‡ã†ã€‚ï¼š900Ã—4=', c: ['3600', '360', '3200']},
    {q: '(ç®—æ•°)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ•°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ã€€4Ã—4=4Ã—5-ðŸ”²', c: ['4', '6', '8']},
    {q: '(ç®—æ•°)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ•°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ã€€7Ã—8=7Ã—7+ðŸ”²', c: ['7', '6', '8']},
    {q: '(ç®—æ•°)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ•°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ã€€5Ã—10=5Ã—ðŸ”²+5', c: ['9', '10', '8']},
    {q: '(ç®—æ•°)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ•°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ã€€20Ã—30=ðŸ”²Ã—10+100', c: ['50', '60', '5']},
    {q: '(ç®—æ•°)1ã•ã¤120å††ã®ãƒŽãƒ¼ãƒˆã‚’5ã•ã¤è²·ã„ã¾ã—ãŸã€‚ä»£é‡‘ã¯ã„ãã‚‰ã§ã™ã‹ã€‚', c: ['600', '520', '500']},
    {q: '(ç®—æ•°)1ã“250å††ã®è‚‰ã¾ã‚“ãŒã€2ã“ãšã¤ç®±ã«å…¥ã£ã¦ã„ã¾ã™ã€‚3ç®±è²·ã†ã¨ã€åˆè¨ˆã®ä»£é‡‘ã¯ã„ãã‚‰ã§ã™ã‹ã€‚', c: ['1500', '750', '1000']},
    {q: '(å›½èªž)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šè¶³ãŒðŸ”²ã„ã€‚', c: ['é€Ÿ', 'æ—©', 'éš¼']},
    {q: '(å›½èªž)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šæ°—ãŒðŸ”²ã„ã€‚', c: ['æ—©', 'é€Ÿ', 'éš¼']},
    {q: '(å›½èªž)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šå…¥å­¦ã®ðŸ”²ðŸ”²ã€‚', c: ['æ™‚æœŸ', 'ç£æ°—', 'æ™‚å­£']},
    {q: '(å›½èªž)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šé£Ÿã¹ç‰©ã®ðŸ”²ðŸ”²ã€‚', c: ['æ¶ˆåŒ–', 'æ¶ˆç«', 'å•†ç§‘']},
    {q: '(å›½èªž)ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šðŸ”²ðŸ”²å™¨ã‚’ä½¿ã†ã€‚', c: ['æ¶ˆç«', 'æ¶ˆåŒ–', 'å•†ç§‘']},
    {q: '(å›½èªž)è¨€è‘‰ãŒå·¦å³ã§äºŒã¤ã§ãã‚‹ã‚ˆã†ã«ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šäºˆâ€ðŸ”²â€å­—', c: ['ç¿’', 'å®š', 'æ–‡']},
    {q: '(å›½èªž)è¨€è‘‰ãŒå·¦å³ã§äºŒã¤ã§ãã‚‹ã‚ˆã†ã«ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šä»£â€ðŸ”²â€è€…', c: ['æ‰“', 'è¡¨', 'å‹']},
    {q: '(å›½èªž)è¨€è‘‰ãŒå·¦å³ã§äºŒã¤ã§ãã‚‹ã‚ˆã†ã«ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šå…¨â€ðŸ”²â€è¿‘', c: ['èº«', 'ä½“', 'é ']},
    {q: '(å›½èªž)è¨€è‘‰ãŒå·¦å³ã§äºŒã¤ã§ãã‚‹ã‚ˆã†ã«ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šè»Šâ€ðŸ”²â€æ–¹', c: ['ä¸¡', 'æ¤œ', 'é ']},
    {q: '(å›½èªž)è¨€è‘‰ãŒå·¦å³ã§äºŒã¤ã§ãã‚‹ã‚ˆã†ã«ðŸ”²ã«ã‚ã¦ã¯ã¾ã‚‹æ¼¢å­—ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚ï¼šå…¥â€ðŸ”²â€æ ¡', c: ['å­¦', 'å ´', 'é«˜']},
    {q: '(ç¤¾ä¼š)åƒè‘‰çœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['åƒè‘‰å¸‚', 'èˆ¹æ©‹å¸‚', 'æµ¦å®‰å¸‚']},
    {q: '(ç¤¾ä¼š)é™å²¡çœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['é™å²¡å¸‚', 'æ¸…æ°´å¸‚', 'æ²¼æ´¥å¸‚']},
    {q: '(ç¤¾ä¼š)å±±æ¢¨çœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['ç”²åºœå¸‚', 'å±±æ¢¨å¸‚', 'ç”²å·žå¸‚']},
    {q: '(ç¤¾ä¼š)ç¦å²¡çœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['ç¦å²¡å¸‚', 'ä¹…ç•™ç±³å¸‚', 'å¤è³€å¸‚']},
    {q: '(ç¤¾ä¼š)æ²–ç¸„çœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['é‚£è¦‡å¸‚', 'æ²–ç¸„å¸‚', 'åè­·å¸‚']},
    {q: '(ç¤¾ä¼š)æ±äº¬éƒ½ã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['æ–°å®¿åŒº', 'å“å·åŒº', 'æ¸‹è°·åŒº']},
    {q: '(ç¤¾ä¼š)æ ƒæœ¨çœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['å®‡éƒ½å®®å¸‚', 'å°å±±å¸‚', 'ä½é‡Žå¸‚']},
    {q: '(ç¤¾ä¼š)å®®åŸŽçœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['ä»™å°å¸‚', 'çŸ³å·»å¸‚', 'æ°—ä»™æ²¼å¸‚']},
    {q: '(ç¤¾ä¼š)ç¥žå¥ˆå·çœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['æ¨ªæµœå¸‚', 'å·å´Žå¸‚', 'æ¨ªé ˆè³€å¸‚']},
    {q: '(ç¤¾ä¼š)å®®å´ŽçœŒã®çœŒåºæ‰€åœ¨åœ°ã‚’ç­”ãˆã¾ã—ã‚‡ã†ã€‚', c: ['å®®å´Žå¸‚', 'å®®åŸŽå¸‚', 'å®®æœ¬å¸‚']},
  ]/*)*/;
  document.getElementById('title').textContent = `å°å­¦4å¹´ç”Ÿã€€å•é¡Œé›†ï¼ˆå…¨${quizSet.length}å•ï¼‰`;

  let currentNum = 0;
  let isAnswered;
  let score = 0;

  function shuffle(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[j], arr[i]] = [arr[i], arr[j]];
    }
    return arr;
  }

  function checkAnswer(li) {
    if (isAnswered === true) {
      return;
    }
    isAnswered = true;

    if (li.textContent === quizSet[currentNum].c[0]) {
      li.classList.add('correct');
      score++;
    } else {
      li.classList.add('wrong');
    }

    btn.classList.remove('disabled');
  }

  function setQuiz() {
    isAnswered = false;

    question.textContent = quizSet[currentNum].q;

    while (choices.firstChild) {
      choices.removeChild(choices.firstChild);
    }

    const shuffledChoices = shuffle([...quizSet[currentNum].c]);
    shuffledChoices.forEach(choice => {
      const li = document.createElement('li');
      li.textContent = choice;
      li.addEventListener('click', () => {
        checkAnswer(li);
      });
      choices.appendChild(li);
    });

    if (currentNum === quizSet.length - 1) {
      btn.textContent = 'çµæžœã‚’è¡¨ç¤ºã™ã‚‹';
    }
  }

  setQuiz();

  btn.addEventListener('click', () => {
    if (btn.classList.contains('disabled')) {
      return;
    }
    btn.classList.add('disabled');

    if (currentNum === quizSet.length - 1) {
      scoreLabel.textContent = `å¾—ç‚¹ï¼š${Math.round(100 / quizSet.length * score)} ç‚¹`;
      result.classList.remove('hidden');
    } else {
      currentNum++;
      setQuiz();
    }
  });

}
